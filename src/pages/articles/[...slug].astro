---
import Container from '#components/Container.astro'
import Avatar from '#components/ui/Avatar.astro'
import BaseLayout from '#layouts/BaseLayout.astro'
import { DEFAULT_CONFIGURATION } from '#lib/constants'
import { Image } from 'astro:assets'
import { getCollection, render } from 'astro:content'

export async function getStaticPaths() {
  const entries = await getCollection('posts')

  return entries.map((entry) => ({
    params: { slug: entry.id },
    props: { entry },
  }))
}

const { entry } = Astro.props
const { Content } = await render(entry)
---

<BaseLayout seo={entry.data.seo}>
  <Container as="section">
    <article>
      <div>
        <a href="/articles"> Back to articles </a>
        <div>
          <Avatar />
          <span>{DEFAULT_CONFIGURATION.author.name}</span>
        </div>
        <h1>{entry.data.title}</h1>
      </div>
      {
        entry.data.image && (
          <div>
            <Image src={entry.data.image} alt={entry.data.title} />
          </div>
        )
      }
      <div>
        <Content />
      </div>
    </article>
  </Container>
</BaseLayout>
