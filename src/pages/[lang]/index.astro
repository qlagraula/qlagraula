---
import BaseLayout from '#layouts/BaseLayout.astro'

import Author from '#components/ui/Author.astro'
import { DEFAULT_CONFIGURATION } from '#lib/constants'
import Contact from '#components/ui/Contact.astro'
import Experience from '#components/ui/Experience.astro'
import { languages } from '#i18n/ui'
import { getLangFromUrl, useTranslations } from '#i18n/utils'
import { getEntry, render } from 'astro:content'

export async function getStaticPaths() {
  return languages.map((lang) => ({ params: { lang } }))
}

const lang = getLangFromUrl(Astro.url)
const t = useTranslations(lang)

const entry = await getEntry('pages', `homepage/${lang}`)

if (!entry) {
  throw new Error('Homepage entry not found')
}

const { Content } = await render(entry)
---

<BaseLayout>
  <section>
    <Author {...DEFAULT_CONFIGURATION.author} />
  </section>

  <section>
    <h2>{t('about')}</h2>

    <Content />
  </section>
  <Contact />
  <Experience />
</BaseLayout>
