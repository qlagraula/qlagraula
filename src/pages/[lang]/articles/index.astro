---
import { getCollection, getEntry } from 'astro:content'
import Author from '#components/ui/Author.astro'

import BaseLayout from '#layouts/BaseLayout.astro'
import { DEFAULT_CONFIGURATION } from '#lib/constants'
import PostPreview from '#components/ui/PostPreview.astro'
import { languages } from '#i18n/ui'
import { getLangFromUrl, useTranslations } from '#i18n/utils'

export async function getStaticPaths() {
  return languages.map((lang) => ({ params: { lang } }))
}

const entry = await getEntry('pages', 'articles')
const posts = await getCollection('posts')

const lang = getLangFromUrl(Astro.url)
const t = useTranslations(lang)
---

<BaseLayout seo={entry?.data.seo}>
  <section>
    <Author {...DEFAULT_CONFIGURATION.author} />
  </section>
  <section>
    <div class="p-8">
      <span>{t("articles.latest")}</span>
      <ul>
        {posts.map((post) => <PostPreview entry={post} />)}
      </ul>
    </div>
  </section>
</BaseLayout>
